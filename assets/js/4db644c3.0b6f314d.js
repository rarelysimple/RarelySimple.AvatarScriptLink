"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2257],{677:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var s=i(5893),n=i(1151);const o={slug:"testing-your-scriptlink-api-with-soapui",title:"Testing Your ScriptLink API with SoapUI",authors:["scottolsonjr"],tags:["scriptlink","myavatar","dotnet","c#","vb","visual basic","visual studio"]},r=void 0,l={permalink:"/blog/testing-your-scriptlink-api-with-soapui",source:"@site/blog/2020-02-18-testing-your-scriptlink-api-with-soapui/index.mdx",title:"Testing Your ScriptLink API with SoapUI",description:"Welcome back to my series on getting started with myAvatar ScriptLink.",date:"2020-02-18T00:00:00.000Z",formattedDate:"February 18, 2020",tags:[{label:"scriptlink",permalink:"/blog/tags/scriptlink"},{label:"myavatar",permalink:"/blog/tags/myavatar"},{label:"dotnet",permalink:"/blog/tags/dotnet"},{label:"c#",permalink:"/blog/tags/c"},{label:"vb",permalink:"/blog/tags/vb"},{label:"visual basic",permalink:"/blog/tags/visual-basic"},{label:"visual studio",permalink:"/blog/tags/visual-studio"}],readingTime:4.6,hasTruncateMarker:!0,authors:[{name:"Scott Olson Jr",title:"RarelySimple.AvatarScriptLink Maintainer",url:"https://github.com/scottolsonjr",imageURL:"https://avatars.githubusercontent.com/u/984715?v=4",key:"scottolsonjr"}],frontMatter:{slug:"testing-your-scriptlink-api-with-soapui",title:"Testing Your ScriptLink API with SoapUI",authors:["scottolsonjr"],tags:["scriptlink","myavatar","dotnet","c#","vb","visual basic","visual studio"]},unlisted:!1,prevItem:{title:"Announcing AvatarScriptLink.NET General Availability",permalink:"/blog/announcing-avatarscriptlink.net-general-availability"},nextItem:{title:"Creating Your First myAvatar ScriptLink API Using C#",permalink:"/blog/creating-your-first-myavatar-scriptlink-api-using-c-sharp"}},a={authorsImageUrls:[void 0]},c=[{value:"What You Will Need",id:"what-you-will-need",level:2},{value:"Start Your Web Application",id:"start-your-web-application",level:2},{value:"Import WSDL into SoapUI",id:"import-wsdl-into-soapui",level:2},{value:"Testing the API",id:"testing-the-api",level:2},{value:"Test #1: GetVersion",id:"test-1-getversion",level:3},{value:"Test #2: Submitting Default OptionObject",id:"test-2-submitting-default-optionobject",level:2},{value:"Test #3: The Modified Default OptionObject",id:"test-3-the-modified-default-optionobject",level:2},{value:"Save Your SoapUI Test Project",id:"save-your-soapui-test-project",level:2},{value:"Happy Testing",id:"happy-testing",level:2}];function d(e){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,n.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Welcome back to my series on getting started with myAvatar ScriptLink.\nToday, we are looking at testing.\nAs tempting as it may be, we should not wait to test our ScriptLink APIs until they are available in production.\nWe want to test our code before it impacts the users.\nIn our first test, we will set up SoapUI to send a request to our development environment and verify the response."}),"\n",(0,s.jsxs)(t.p,{children:["When we left off, we had ",(0,s.jsx)(t.a,{href:"/blog/creating-your-first-myavatar-scriptlink-api-using-c-sharp",children:"created our first Hello World ScriptLink API in .NET using C#"})," and Visual Basic.\nIf we created them correctly, the we should be able to call the RunScript method with the HelloWorld parameter and receive an Error Code 3 with the ErrorMsg \"Hello, World!'.\nLet\u2019s test that."]}),"\n","\n",(0,s.jsx)(t.h2,{id:"what-you-will-need",children:"What You Will Need"}),"\n",(0,s.jsx)(t.p,{children:"To complete this walkthrough, you will need the following:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://visualstudio.microsoft.com/",children:"Visual Studio Community 2019"})}),"\n",(0,s.jsxs)(t.li,{children:["The Hello World solution we set up previously.",(0,s.jsx)("br",{}),"I will be using the C# solution for my examples, but the process is the same for the Visual Basic solution."]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://www.soapui.org/",children:"SoapUI"})}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Visual Studio Community 2019 and SoapUI are free to download and use. Paid versions will add additional features that we will not use in this walkthrough."}),"\n",(0,s.jsxs)(t.p,{children:["If you don\u2019t have your Hello World API setup yet, go back to my ",(0,s.jsx)(t.a,{href:"/blog/creating-your-first-myavatar-scriptlink-api-using-c-sharp",children:"previous article"})," to set it up."]}),"\n",(0,s.jsx)(t.h2,{id:"start-your-web-application",children:"Start Your Web Application"}),"\n",(0,s.jsx)(t.p,{children:"Our first step is to open our solution in Visual Studio and run it."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Launch ",(0,s.jsx)(t.strong,{children:"Visual Studio 2019"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Open our ScriptLink demo solution"}),". For me, it is RS.ScriptLinkDemo."]}),"\n",(0,s.jsxs)(t.li,{children:["Press ",(0,s.jsx)(t.strong,{children:"F5"})," to begin debugging the solution."]}),"\n",(0,s.jsx)(t.li,{children:"You may receive a security alert like this. This means that the browser does not trust the SSL certificate provided by Visual Studio. Go ahead and proceed."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Untrusted Visual Studio SSL Certificate Shown in Mozilla Firefox 70",src:i(8926).Z+"",width:"1023",height:"725"})}),"\n",(0,s.jsxs)(t.ol,{start:"5",children:["\n",(0,s.jsx)(t.li,{children:"If you see the default homepage of our web application like this, then you will need to enter the path to the ScriptLinkController."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Web Application Homepage Forbidden",src:i(2869).Z+"",width:"1023",height:"725"})}),"\n",(0,s.jsxs)(t.ol,{start:"6",children:["\n",(0,s.jsx)(t.li,{children:"Once you are at your ScriptLinkController API you should see a screen like this."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"ScriptLinkController Debugging in Mozilla Firefox 70",src:i(9927).Z+"",width:"1023",height:"725"})}),"\n",(0,s.jsxs)(t.ol,{start:"7",children:["\n",(0,s.jsxs)(t.li,{children:["Confirm and copy the URL of your WSDL. Mine is: ",(0,s.jsx)(t.a,{href:"http://localhost:####/api/v3/ScriptLinkController.asmx?WSDL",children:"http://localhost:####/api/v3/ScriptLinkController.asmx?WSDL"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"The content of the ScriptLink WSDL displayed in Mozilla Firefox 70",src:i(5481).Z+"",width:"1023",height:"725"})}),"\n",(0,s.jsx)(t.h2,{id:"import-wsdl-into-soapui",children:"Import WSDL into SoapUI"}),"\n",(0,s.jsx)(t.p,{children:"Next, we will launch SoapUI and import our WSDL into a new test project."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Launch ",(0,s.jsx)(t.strong,{children:"SoapUI"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Select ",(0,s.jsx)(t.strong,{children:"SOAP"})," in the Task bar to create a new SOAP Project."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Paste the WSDL URL"})," into the ",(0,s.jsx)(t.em,{children:"Initial WSDL"})," field."]}),"\n",(0,s.jsx)(t.li,{children:"Optional: Customize the Project name."}),"\n",(0,s.jsxs)(t.li,{children:["Select ",(0,s.jsx)(t.strong,{children:"OK"}),"."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Creating a new SOAP Project in SoapUI",src:i(3273).Z+"",width:"560",height:"266"})}),"\n",(0,s.jsx)(t.p,{children:"You should now have a SOAP project that looks something like this."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"SoapUI showing new ScriptLink SOAP Project",src:i(2834).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsx)(t.p,{children:"Ok. Let\u2019s run some tests."}),"\n",(0,s.jsx)(t.h2,{id:"testing-the-api",children:"Testing the API"}),"\n",(0,s.jsx)(t.p,{children:"For our first test, we are going to see what happens when we submit the default test."}),"\n",(0,s.jsx)(t.h3,{id:"test-1-getversion",children:"Test #1: GetVersion"}),"\n",(0,s.jsx)(t.p,{children:"Our first test will be relatively straightforward. We want to get our GetVersion string back. When we created the SOAP project, SoapUI created default requests for us."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Expand GetVersion."}),(0,s.jsx)("br",{}),'You can use either interface. However, I will be using the one that does not end in "12".']}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Double-click on Request 1"})," to open it."]}),"\n",(0,s.jsx)(t.li,{children:"You should now see the default XML request displayed and ready for submission."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"ScriptLink GetVersion Request in SoapUI",src:i(1955).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsxs)(t.ol,{start:"4",children:["\n",(0,s.jsxs)(t.li,{children:["Select the ",(0,s.jsx)(t.strong,{children:"Play"})," icon (Alt+Enter) to submit request."]}),"\n",(0,s.jsx)(t.li,{children:"You should have received and XML response."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"ScriptLink GetVersion Response in SoapUI",src:i(8986).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsx)(t.p,{children:"If the test was successful, then you should see the version number you set previously displayed in the GetVersionResult tag. If not, make sure your web application is still running."}),"\n",(0,s.jsx)(t.h2,{id:"test-2-submitting-default-optionobject",children:"Test #2: Submitting Default OptionObject"}),"\n",(0,s.jsx)(t.p,{children:"Ok. Now for the real test."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Expand the RunScript node"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Right-click on Request 1"})," and select ",(0,s.jsx)(t.strong,{children:"Rename"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:["Name the request ",(0,s.jsx)(t.em,{children:"Default Request"})," and select ",(0,s.jsx)(t.strong,{children:"OK"}),"."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Renamed Request in SoapUI",src:i(2231).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsxs)(t.ol,{start:"4",children:["\n",(0,s.jsx)(t.li,{children:"Double-click on the Default Request to open it."}),"\n",(0,s.jsx)(t.li,{children:"You should now have a default OptionObject2015 on the left and an empty result view on the right."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"ScriptLink RunScript Request shown in SoapUI",src:i(1126).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsxs)(t.ol,{start:"6",children:["\n",(0,s.jsxs)(t.li,{children:["Select the ",(0,s.jsx)(t.strong,{children:"Play"})," icon (Alt+Enter) to submit the request."]}),"\n",(0,s.jsx)(t.li,{children:"You should get a result like this."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"ScriptLink RunScript Error Response shown in SoapUI",src:i(318).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsx)(t.p,{children:"So what happened? Three things happened. The submitted OptionObject2015 included the following invalid values:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.code,{children:"?"})," in EpisodeNumber."]}),"\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.code,{children:"?"})," in ErrorCode."]}),"\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.code,{children:"?"})," in MultipleIteration value."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"To fix this:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Set the EpisodeNumber to 0."}),"\n",(0,s.jsx)(t.li,{children:"Remove the ErrorCode and ErrorMesg tags. These are not relevant on submission anyway."}),"\n",(0,s.jsx)(t.li,{children:"Set the MultipleIteration value to 0."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"test-3-the-modified-default-optionobject",children:"Test #3: The Modified Default OptionObject"}),"\n",(0,s.jsx)(t.p,{children:"With the modifications in place your OptionObject request should look something like this."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Corrected ScriptLink Default RunScript Request in SoapUI",src:i(7246).Z+"",width:"1023",height:"669"})}),"\n",(0,s.jsx)(t.p,{children:"Now when we run the test we should get an OptionObject2015 back. Did you?"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"ScriptLink RunScript Hello World Response in SoapUI",src:i(3121).Z+"",width:"1196",height:"782"})}),"\n",(0,s.jsx)(t.p,{children:'If successful, you should see the ErrorCode "3" and ErrorMesg "Hello, World!" in the response XML.'}),"\n",(0,s.jsx)(t.h2,{id:"save-your-soapui-test-project",children:"Save Your SoapUI Test Project"}),"\n",(0,s.jsx)(t.p,{children:"To help with future testing, let\u2019s save our SoapUI test project. This should eliminate the need to import the WSDL again, unless we change ports."}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Select ",(0,s.jsx)(t.strong,{children:"File->Save All Projects"}),"."]}),"\n",(0,s.jsx)(t.li,{children:"You should receive a prompt indicating that the project has not been saved."}),"\n",(0,s.jsxs)(t.li,{children:["Select ",(0,s.jsx)(t.strong,{children:"Yes"})," to save the project."]}),"\n",(0,s.jsxs)(t.li,{children:["Select a location for the project file and select ",(0,s.jsx)(t.strong,{children:"Save"}),"."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"happy-testing",children:"Happy Testing"}),"\n",(0,s.jsx)(t.p,{children:"There you go. You are all set to set testing your ScriptLink APIs with SoapUI. Enjoy!"})]})}function h(e={}){const{wrapper:t}={...(0,n.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},3273:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-new-soap-project-580a95d709941fa521062d79dd8f2b94.png"},1955:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-getversion-request-d58c9acdda1eba5d375488faffb9c3da.webp"},8986:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-getversion-response-24a39de77a1f92b44897e57f41b971b8.webp"},2834:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-project-901406876da26cbf09e889c4ed277a24.webp"},2231:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-runscript-default-request-60992ef09adf6d246f5db96670971868.webp"},7246:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-runscript-request-fixed-1c36e9993dbaac9303b716a8e0136993.webp"},1126:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-runscript-request-389221e983fdb02706da7dc6f02a3437.webp"},318:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-runscript-response-error-c2d44b772603178c6566cf30778f5e7c.webp"},3121:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/soapui-scriptlink-soap-runscript-response-fixed-c46b1cac290082d18fb1add87be69aaa.png"},2869:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/visual-studio-2019-site-homepage-forbidden-64895df0a67271682150e9bc5816968b.webp"},5481:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/visual-studio-2019-soap-api-wsdl-b18c15a3d91c5c6edff0e181afedd33c.webp"},9927:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/visual-studio-2019-soap-api-01fae9c855789d74152779c64910484f.webp"},8926:(e,t,i)=>{i.d(t,{Z:()=>s});const s=i.p+"assets/images/visual-studio-2019-untrusted-ssl-certificate-a0f68b130411293056026ee6e0a2ce2e.webp"},1151:(e,t,i)=>{i.d(t,{Z:()=>l,a:()=>r});var s=i(7294);const n={},o=s.createContext(n);function r(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);